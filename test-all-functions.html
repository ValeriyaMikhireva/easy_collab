<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–¢–µ—Å—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π</title>
    <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .test-result { 
            margin: 10px 0; 
            padding: 10px; 
            border-radius: 5px; 
            border: 1px solid #ccc;
        }
        .success { background: #d4edda; border-color: #c3e6cb; color: #155724; }
        .error { background: #f8d7da; border-color: #f5c6cb; color: #721c24; }
        .warning { background: #fff3cd; border-color: #ffeaa7; color: #856404; }
        .test-section { margin: 20px 0; }
        button { padding: 8px 16px; margin: 5px; cursor: pointer; }
    </style>
</head>
<body>
    <h1>üß™ –¢–µ—Å—Ç –≤—Å–µ—Ö —Ñ—É–Ω–∫—Ü–∏–π —Å–∞–π—Ç–∞</h1>
    
    <div class="test-section">
        <h2>1. –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∫–æ–º–ø–∞–Ω–∏–π</h2>
        <div id="data-test">–¢–µ—Å—Ç–∏—Ä—É–µ–º...</div>
    </div>
    
    <div class="test-section">
        <h2>2. –ü–∞—Ä—Å–∏–Ω–≥ CSV</h2>
        <div id="parsing-test">–¢–µ—Å—Ç–∏—Ä—É–µ–º...</div>
    </div>
    
    <div class="test-section">
        <h2>3. –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–π</h2>
        <div id="display-test">–¢–µ—Å—Ç–∏—Ä—É–µ–º...</div>
        <div id="companies-preview"></div>
    </div>
    
    <div class="test-section">
        <h2>4. –§–∏–ª—å—Ç—Ä—ã</h2>
        <button onclick="testFilters()">–¢–µ—Å—Ç —Ñ–∏–ª—å—Ç—Ä–æ–≤</button>
        <div id="filter-test"></div>
    </div>
    
    <div class="test-section">
        <h2>5. –ü–æ–∏—Å–∫</h2>
        <button onclick="testSearch()">–¢–µ—Å—Ç –ø–æ–∏—Å–∫–∞</button>
        <div id="search-test"></div>
    </div>
    
    <div class="test-section">
        <h2>6. –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</h2>
        <div id="images-test">–ü—Ä–æ–≤–µ—Ä—è–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è...</div>
    </div>

    <script>
        let companies = [];
        let filteredCompanies = [];
        
        // –ö–æ–ø–∏—Ä—É–µ–º —Ñ—É–Ω–∫—Ü–∏–∏ –∏–∑ script.js –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
        
        // –§—É–Ω–∫—Ü–∏—è –ø–∞—Ä—Å–∏–Ω–≥–∞ CSV
        function parseCSV(csv) {
            const lines = csv.split('\n').filter(line => line.trim());
            
            if (lines.length < 2) {
                return [];
            }
            
            function parseCSVLine(text) {
                const result = [];
                let current = '';
                let inQuotes = false;
                let i = 0;
                
                while (i < text.length) {
                    const char = text[i];
                    const nextChar = text[i + 1];
                    
                    if (char === '"') {
                        if (inQuotes && nextChar === '"') {
                            current += '"';
                            i += 2;
                            continue;
                        } else {
                            inQuotes = !inQuotes;
                        }
                    } else if (char === ',' && !inQuotes) {
                        result.push(current.trim());
                        current = '';
                        i++;
                        continue;
                    } else {
                        current += char;
                    }
                    i++;
                }
                
                result.push(current.trim());
                return result;
            }
            
            const headers = parseCSVLine(lines[0]);
            const companies = [];
            
            for (let i = 1; i < lines.length; i++) {
                if (lines[i].trim()) {
                    const values = parseCSVLine(lines[i]);
                    const company = {};
                    headers.forEach((header, index) => {
                        company[header] = values[index] || '';
                    });
                    companies.push(company);
                }
            }
            
            return companies;
        }
        
        // –§—É–Ω–∫—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∏—è –∑–Ω–∞—á–µ–Ω–∏—è –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ –±–∏–∑–Ω–µ—Å–∞
        function getBusinessAreaValue(businessArea) {
            const businessAreaMap = {
                '–°–∞–ª–æ–Ω—ã –∫—Ä–∞—Å–æ—Ç—ã': 'beauty',
                '–§–∏—Ç–Ω–µ—Å –∏ wellness': 'fitness',
                '–ü—Å–∏—Ö–æ–ª–æ–≥–∏—è –∏ –∫–æ—É—á–∏–Ω–≥': 'psychology',
                '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ': 'education',
                '–ö–æ—Ñ–µ–π–Ω—è': 'beauty',
                'IT –∏ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞': 'tech',
                '–§–æ—Ç–æ–≥—Ä–∞—Ñ–∏—è': 'creativity',
                '–ö–æ–Ω—Å—É–ª—å—Ç–∞—Ü–∏–∏': 'consulting'
            };
            return businessAreaMap[businessArea] || businessArea.toLowerCase();
        }
        
        // –û—Å–Ω–æ–≤–Ω–æ–π —Ç–µ—Å—Ç
        async function runTests() {
            console.log('üöÄ –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–æ–≤');
            
            try {
                // –¢–µ—Å—Ç 1: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö
                const response = await fetch('kollab_data.csv');
                if (!response.ok) {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
                const csvData = await response.text();
                document.getElementById('data-test').innerHTML = 
                    `<div class="test-result success">‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ (${csvData.length} —Å–∏–º–≤–æ–ª–æ–≤)</div>`;
                
                // –¢–µ—Å—Ç 2: –ü–∞—Ä—Å–∏–Ω–≥
                companies = parseCSV(csvData);
                filteredCompanies = [...companies];
                
                if (companies.length > 0) {
                    document.getElementById('parsing-test').innerHTML = 
                        `<div class="test-result success">‚úÖ –ü–∞—Ä—Å–∏–Ω–≥ —É—Å–ø–µ—à–µ–Ω (${companies.length} –∫–æ–º–ø–∞–Ω–∏–π)</div>
                         <div><strong>–ü–æ–ª—è –ø–µ—Ä–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏:</strong> ${Object.keys(companies[0]).join(', ')}</div>`;
                } else {
                    document.getElementById('parsing-test').innerHTML = 
                        `<div class="test-result error">‚ùå –ü–∞—Ä—Å–∏–Ω–≥ –Ω–µ—É–¥–∞—á–µ–Ω - –∫–æ–º–ø–∞–Ω–∏–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω—ã</div>`;
                }
                
                // –¢–µ—Å—Ç 3: –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
                testDisplay();
                
                // –¢–µ—Å—Ç 6: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è
                testImages();
                
            } catch (error) {
                console.error('–û—à–∏–±–∫–∞ —Ç–µ—Å—Ç–∞:', error);
                document.getElementById('data-test').innerHTML = 
                    `<div class="test-result error">‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏: ${error.message}</div>`;
            }
        }
        
        function testDisplay() {
            if (companies.length === 0) {
                document.getElementById('display-test').innerHTML = 
                    `<div class="test-result error">‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è</div>`;
                return;
            }
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Å–æ–∑–¥–∞–Ω–∏–µ –∫–∞—Ä—Ç–æ—á–µ–∫ –∫–æ–º–ø–∞–Ω–∏–π
            const company = companies[0];
            const adOpportunities = [];
            const adOpportunitiesText = company['–ö–∞–∫–∏–µ —Ä–µ–∫–ª–∞–º–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ —É –≤–∞—Å –µ—Å—Ç—å? (–º–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ) '] || '';
            
            if (adOpportunitiesText.includes('–ø–µ—á–∞—Ç–Ω—ã—Ö –º–∞—Ç–µ—Ä–∏–∞–ª–æ–≤') || adOpportunitiesText.includes('–ü–µ—á–∞—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞')) {
                adOpportunities.push('–ü–µ—á–∞—Ç–Ω–∞—è —Ä–µ–∫–ª–∞–º–∞');
            }
            if (adOpportunitiesText.includes('—Å–æ—Ü—Å–µ—Ç—è—Ö') || adOpportunitiesText.includes('Digital —Ä–µ–∫–ª–∞–º–∞')) {
                adOpportunities.push('–†–µ–∫–ª–∞–º–∞ –≤ —Å–æ—Ü—Å–µ—Ç—è—Ö');
            }
            
            const barterField = company['–ë–∞—Ä—Ç–µ—Ä'] || '';
            const hasBarterInfo = barterField && barterField.trim() !== '';
            
            document.getElementById('display-test').innerHTML = 
                `<div class="test-result success">‚úÖ –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç</div>`;
            
            document.getElementById('companies-preview').innerHTML = `
                <h4>–ü—Ä–µ–≤—å—é –ø–µ—Ä–≤–æ–π –∫–æ–º–ø–∞–Ω–∏–∏:</h4>
                <div style="border: 1px solid #ddd; padding: 15px; border-radius: 8px; background: #f9f9f9;">
                    <h3>${company['–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ / –ò–º—è –≠–∫—Å–ø–µ—Ä—Ç–∞']}</h3>
                    <p><strong>–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</strong> ${company['–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞']}</p>
                    <p><strong>–û–ø–∏—Å–∞–Ω–∏–µ:</strong> ${company['–ö–æ—Ä–æ—Ç–∫–æ –æ –∫–æ–º–ø–∞–Ω–∏–∏ (2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)']}</p>
                    <p><strong>–†–µ–∫–ª–∞–º–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:</strong> ${adOpportunities.join(', ') || '–ù–µ —É–∫–∞–∑–∞–Ω–æ'}</p>
                    <p><strong>–ë–∞—Ä—Ç–µ—Ä:</strong> ${hasBarterInfo ? '–î–∞' : '–ù–µ—Ç'}</p>
                    <p><strong>–ö–æ–Ω—Ç–∞–∫—Ç:</strong> ${company['–í–∞—à –ù–∏–∫ –≤ Telegram –¥–ª—è —Å–≤—è–∑–∏']}</p>
                </div>
            `;
        }
        
        function testFilters() {
            if (companies.length === 0) {
                document.getElementById('filter-test').innerHTML = 
                    `<div class="test-result error">‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏</div>`;
                return;
            }
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—é –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º
            const categories = [...new Set(companies.map(c => c['–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞']))];
            const filteredByEducation = companies.filter(c => c['–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞'] === '–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ');
            const filteredByFitness = companies.filter(c => c['–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞'] === '–§–∏—Ç–Ω–µ—Å –∏ wellness');
            
            document.getElementById('filter-test').innerHTML = `
                <div class="test-result success">‚úÖ –§–∏–ª—å—Ç—Ä—ã —Ä–∞–±–æ—Ç–∞—é—Ç</div>
                <div><strong>–î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏:</strong> ${categories.join(', ')}</div>
                <div><strong>–ö–æ–º–ø–∞–Ω–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ":</strong> ${filteredByEducation.length}</div>
                <div><strong>–ö–æ–º–ø–∞–Ω–∏–π –≤ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ "–§–∏—Ç–Ω–µ—Å –∏ wellness":</strong> ${filteredByFitness.length}</div>
            `;
        }
        
        function testSearch() {
            if (companies.length === 0) {
                document.getElementById('search-test').innerHTML = 
                    `<div class="test-result error">‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø–æ–∏—Å–∫–∞</div>`;
                return;
            }
            
            // –¢–µ—Å—Ç–∏—Ä—É–µ–º –ø–æ–∏—Å–∫
            const searchTerm = '–ü—Å–∏—Ö–æ–ú–∞—Ä–∫–µ—Ç–∏–Ω–≥';
            const searchResults = companies.filter(company => {
                const searchText = [
                    company['–ù–∞–∑–≤–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ / –ò–º—è –≠–∫—Å–ø–µ—Ä—Ç–∞'],
                    company['–ù–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –±–∏–∑–Ω–µ—Å–∞'],
                    company['–ö–æ—Ä–æ—Ç–∫–æ –æ –∫–æ–º–ø–∞–Ω–∏–∏ (2‚Äì3 –ø—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è)']
                ].join(' ').toLowerCase();
                return searchText.includes(searchTerm.toLowerCase());
            });
            
            document.getElementById('search-test').innerHTML = `
                <div class="test-result success">‚úÖ –ü–æ–∏—Å–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç</div>
                <div><strong>–ü–æ–∏—Å–∫ "${searchTerm}":</strong> –Ω–∞–π–¥–µ–Ω–æ ${searchResults.length} —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤</div>
            `;
        }
        
        function testImages() {
            if (companies.length === 0) {
                document.getElementById('images-test').innerHTML = 
                    `<div class="test-result error">‚ùå –ù–µ—Ç –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π</div>`;
                return;
            }
            
            const images = companies.map(c => c['–õ–æ–≥–æ –∫–æ–º–ø–∞–Ω–∏–∏']).filter(img => img && img.trim());
            let imageResults = `<div class="test-result success">‚úÖ –ù–∞–π–¥–µ–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π: ${images.length}</div>`;
            
            images.forEach(imagePath => {
                imageResults += `<div>üìÅ ${imagePath}</div>`;
            });
            
            document.getElementById('images-test').innerHTML = imageResults;
        }
        
        // –ó–∞–ø—É—Å–∫–∞–µ–º —Ç–µ—Å—Ç—ã –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã
        runTests();
    </script>
</body>
</html>
